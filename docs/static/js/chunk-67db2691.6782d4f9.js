(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-67db2691"],{2786:function(t,e,a){},5108:function(t,e,a){t.exports=a.p+"static/img/fact-dec-banner.c193d140.svg"},"6e57":function(t,e,a){"use strict";var r=a("2786"),s=a.n(r);s.a},7424:function(t,e){var a=Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_API_BASE_URL;t.exports={LOGIN:"".concat(a,"/login"),ROUTES:"".concat(a,"/routes"),GOODS:"".concat(a,"/goods"),GOODS_COLUMNS:"".concat(a,"/columns")}},"80c1":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("common-layout",[r("div",{staticClass:"top"},[r("div",{staticClass:"header"},[r("img",{staticClass:"logo",attrs:{alt:"logo",src:a("9632")}}),r("span",{staticClass:"title"},[t._v(t._s(t.systemName))])]),r("div",{staticClass:"desc"},[t._v("一个简单的人脸识别系统")])]),r("div",{staticClass:"login"},[r("a-form",{attrs:{form:t.form},on:{submit:t.onSubmit}},[r("a-tabs",{staticStyle:{padding:"0 2px"},attrs:{size:"large",tabBarStyle:{textAlign:"center"}}},[r("a-tab-pane",{key:"1",attrs:{tab:"账户密码登录"}},[r("a-form-item",[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入账户名",whitespace:!0}]}],expression:"['name', {rules: [{ required: true, message: '请输入账户名', whitespace: true}]}]"}],attrs:{autocomplete:"autocomplete",size:"large",placeholder:"请输入用户名"}},[r("a-icon",{attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),r("a-form-item",[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,message:"请输入密码",whitespace:!0}]}],expression:"['password', {rules: [{ required: true, message: '请输入密码', whitespace: true}]}]"}],attrs:{size:"large",placeholder:"请输入密码",autocomplete:"autocomplete",type:"password"}},[r("a-icon",{attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),r("div",[r("a-checkbox",{attrs:{checked:!0}},[t._v("自动登录")]),r("a",{staticStyle:{float:"right"}},[t._v("忘记密码")])],1),r("a-form-item",[r("a-button",{staticStyle:{width:"100%","margin-top":"24px"},attrs:{loading:t.logging,size:"large",htmlType:"submit",type:"primary"}},[t._v("登录")])],1),r("div",[t._v(" 其他登录方式 "),r("a-icon",{staticClass:"icon",attrs:{type:"alipay-circle"}}),r("a-icon",{staticClass:"icon",attrs:{type:"taobao-circle"}}),r("a-icon",{staticClass:"icon",attrs:{type:"weibo-circle"}}),r("router-link",{staticStyle:{float:"right"},attrs:{to:"/dashboard/workplace"}},[t._v("注册账户")])],1)],1),r("a-tab-pane",{key:"2",attrs:{tab:"刷脸登录"}},[r("a-form-item",[r("a-modal",{attrs:{title:"请用微信扫码进行认证",visible:t.visible,"confirm-loading":t.confirmLoading,"ok-text":"我已完成"},on:{ok:t.handleOk,cancel:t.handleCancel}},[t.error?r("a-alert",{staticStyle:{"margin-bottom":"24px"},attrs:{type:t.alertType,message:t.message,showIcon:""}}):t._e(),r("img",{staticStyle:{width:"100%"},attrs:{src:t.qrCodeUrl,alt:""}})],1),r("img",{staticStyle:{width:"100%"},attrs:{src:a("5108"),alt:""}}),r("a-button",{staticStyle:{width:"100%","margin-top":"24px"},attrs:{loading:t.logging,size:"large",htmlType:"submit",type:"primary"},on:{click:t.showModal}},[t._v("开始认证")])],1)],1)],1)],1)],1)])},s=[],i=(a("d3b7"),a("5530")),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"common-layout"},[a("div",{staticClass:"content"},[t._t("default")],2),a("page-footer",{attrs:{"link-list":t.footerLinks,copyright:t.copyright}})],1)},n=[],c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"footer"},[a("div",{staticClass:"links"},t._l(t.linkList,(function(e,r){return a("a",{key:r,attrs:{target:"_blank",href:e.link?e.link:"javascript: void(0)"}},[e.icon?a("a-icon",{attrs:{type:e.icon}}):t._e(),t._v(t._s(e.name)+" ")],1)})),0),a("div",{staticClass:"copyright"},[t._v(" Copyright"),a("a-icon",{attrs:{type:"copyright"}}),t._v(t._s(t.copyright)+" ")],1)])},l=[],u={name:"PageFooter",props:["copyright","linkList"]},p=u,d=(a("b2bf"),a("0c7c")),m=Object(d["a"])(p,c,l,!1,null,"1e9bb40c",null),h=m.exports,f=a("5880"),g={name:"CommonLayout",components:{PageFooter:h},computed:Object(i["a"])({},Object(f["mapState"])("setting",["footerLinks","copyright"]))},b=g,v=(a("6e57"),Object(d["a"])(b,o,n,!1,null,"63c094a6",null)),y=v.exports,w=(a("96cf"),a("1da1")),_=a("7424"),O=a("b775");function k(t,e){return x.apply(this,arguments)}function x(){return x=Object(w["a"])(regeneratorRuntime.mark((function t(e,a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(O["d"])(_["LOGIN"],O["a"].POST,{name:e,password:a}));case 1:case"end":return t.stop()}}),t)}))),x.apply(this,arguments)}function S(){return C.apply(this,arguments)}function C(){return C=Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(O["d"])(_["ROUTES"],O["a"].GET));case 1:case"end":return t.stop()}}),t)}))),C.apply(this,arguments)}var j=a("89a5"),L={name:"Login",components:{CommonLayout:y},data:function(){return{logging:!1,alertType:"error",error:"",message:"",form:this.$form.createForm(this),ModalText:"请用微信扫码进行认证",visible:!1,confirmLoading:!1,qrCodeUrl:"",id:"",baseUrl:"https://service-7wtzjrxq-1301774019.gz.apigw.tencentcs.com"}},computed:{systemName:function(){return this.$store.state.setting.systemName}},methods:Object(i["a"])(Object(i["a"])({},Object(f["mapMutations"])("account",["setUser","setPermissions","setRoles"])),{},{onSubmit:function(t){var e=this;t.preventDefault(),this.form.validateFields((function(t){if(!t){e.logging=!0;var a=e.form.getFieldValue("name"),r=e.form.getFieldValue("password");k(a,r).then(e.afterLogin)}}))},showModal:function(){var t=this,e=new Headers;e.append("Content-Type","text/plain");var a="wzr",r={method:"POST",headers:e,body:a,redirect:"follow"};fetch("".concat(this.baseUrl,"/QRCodeServer"),r).then((function(t){return t.json()})).then((function(e){t.qrCodeUrl="data:image/jpeg;base64,"+e.image,t.id=e.id,t.visible=!0}))},handleOk:function(){var t=this;this.confirmLoading=!0,fetch("".concat(this.baseUrl,"/checkSateServer"),{method:"POST",body:JSON.stringify({id:this.id})}).then((function(t){return t.json()})).then((function(e){"1"===e.error_code?(t.confirmLoading=!1,t.showAlert("success","验证成功，你是"+e.uid+"正在跳转..."),setTimeout((function(){t.visible=!1}),2e3),setTimeout((function(){S().then((function(e){var a=e.data.data;Object(j["d"])(a),t.$router.push("/dashboard/workplace")}))}),3e3)):(t.showAlert("error","验证失败，请重新扫码或刷新页面"),t.confirmLoading=!1)}))},handleCancel:function(){this.visible=!1,this.confirmLoading=!1},afterLogin:function(t){var e=this;this.logging=!1;var a=t.data;if(a.code>=0){var r=a.data,s=r.user,i=r.permissions,o=r.roles;this.setUser(s),this.setPermissions(i),this.setRoles(o),Object(O["e"])({token:a.data.token,expireAt:new Date(a.data.expireAt)}),S().then((function(t){var r=t.data.data;Object(j["d"])(r),e.$router.push("/"),e.$message.success(a.message,3)}))}else this.error=a.message},showAlert:function(t,e){var a=this;this.error=!1,"success"===t?(this.alertType="success",this.error=!0):"error"===t&&(this.alertType="error",this.error=!0),this.message=e,setTimeout((function(){a.error=!1}),3e3)}})},T=L,U=(a("890f"),Object(d["a"])(T,r,s,!1,null,"d3419e7a",null)),E=U.exports;e["default"]=E},"890f":function(t,e,a){"use strict";var r=a("8b53"),s=a.n(r);s.a},"8b53":function(t,e,a){},9632:function(t,e,a){t.exports=a.p+"static/img/xidian-logo-red.189c51c4.png"},b2bf:function(t,e,a){"use strict";var r=a("e25c"),s=a.n(r);s.a},e25c:function(t,e,a){}}]);